<!--
  COMPOSANT : Formulaire de création de Tier
  DESCRIPTION : Interface de création d'un nouveau tier (client, fournisseur, partenaire)
  VERSION : 1.0.0
  AUTEUR : CHABEHOU AFFERY AUXENCE DELORS
-->

<div class="layout-wrapper">
  <!-- =========================================================================== -->
  <!-- SECTION : SIDEBAR PRINCIPALE (NAVIGATION) -->
  <!-- =========================================================================== -->
  <aside class="layout-menu" id="sidebar">
    <!-- En-tête de la sidebar -->
    <div class="app-brand">
      <i class='bx bxs-truck' style="font-size: 2rem; color: white;"></i>
      <div>
        <span class="app-brand-text">Logistiks</span>
        <div class="app-brand-subtitle">Gestion de flotte et locations</div>
      </div>
    </div>

    <!-- Menu de navigation -->
    <ul class="menu-inner">
      <!-- Section : Accueil -->
      <li class="menu-item" routerLinkActive="active">
        <a [routerLink]="['/dashboard']" class="menu-link">
          <i class="menu-icon bx bx-home-circle"></i>
          <div>Dashboard</div>
        </a>
      </li>

      <!-- Section : Référentiels -->
      <li class="menu-header">
        <span>RÉFÉRENTIELS</span>
      </li>

      <!-- Sous-section : Tiers -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-group"></i>
          <div>Tiers</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers']" class="menu-link">
              <div>Tous les tiers</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers/documents-validation']" class="menu-link">
              <div>Documents à valider</div>
              <span class="badge badge-warning" *ngIf="dashboardStats.documentsPending > 0">
                {{ dashboardStats.documentsPending }}
              </span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers/documents-management']" class="menu-link">
              <div>Gestion des documents</div>
              <span class="badge badge-info">
                <i class='bx bx-upload'></i>
                {{ dashboardStats.documentsPending > 0 ? dashboardStats.documentsPending : '' }}
              </span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers/new']" class="menu-link">
              <div>Nouveau tier</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Sous-section : Véhicules -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-car"></i>
          <div>Véhicules</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules']" class="menu-link">
              <div>Tous les véhicules</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/ajouter']" class="menu-link">
              <div>Ajouter vehicule</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/affectations']" class="menu-link">
              <div>Affectations</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/entretien']" class="menu-link">
              <div>Suivi entretien</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/assurances']" class="menu-link">
              <div>Assurances</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Sous-section : Documents -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-folder"></i>
          <div>Documents</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents']" class="menu-link">
              <div>Tous les documents</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents/contrats']" class="menu-link">
              <div>Contrats signés</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents/identite']" class="menu-link">
              <div>Pièces d'identité</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents/factures']" class="menu-link">
              <div>Factures fournisseurs</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Section : Cœur Métier -->
      <li class="menu-header">
        <span>CŒUR MÉTIER</span>
      </li>

      <!-- Sous-section : Contrats -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-file"></i>
          <div>Contrats</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats']" class="menu-link">
              <div>Tous les contrats</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats/actifs']" class="menu-link">
              <div>Contrats actifs</div>
              <span class="badge badge-success">12</span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats/expiration']" class="menu-link">
              <div>À expiration</div>
              <span class="badge badge-warning">3</span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats/new']" class="menu-link">
              <div>Nouveau contrat</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Item : Calendrier -->
      <li class="menu-item" routerLinkActive="active">
        <a [routerLink]="['/dashboard/calendrier']" class="menu-link">
          <i class="menu-icon bx bx-calendar"></i>
          <div>Calendrier & Échéances</div>
        </a>
      </li>

      <!-- Section : Finance & Comptabilité -->
      <li class="menu-header">
        <span>FINANCE & COMPTABILITÉ</span>
      </li>

      <!-- Sous-section : Comptes -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-credit-card"></i>
          <div>Comptes</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/comptes-bancaires']" class="menu-link">
              <div>Comptes bancaires</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/mobile-money']" class="menu-link">
              <div>Mobile Money</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/bilans']" class="menu-link">
              <div>Soldes & Bilans</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Sous-section : Paiements -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-wallet"></i>
          <div>Paiements</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/paiements']" class="menu-link">
              <div>Tous les paiements</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/paiements/retard']" class="menu-link">
              <div>En retard</div><span class="badge badge-danger">5</span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/paiements/attente']" class="menu-link">
              <div>En attente</div><span class="badge badge-warning">8</span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Section : Administration -->
      <li class="menu-header">
        <span>ADMINISTRATION</span>
      </li>

      <!-- Sous-section : Utilisateurs -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-user"></i>
          <div>Utilisateurs</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/users-list']" class="menu-link">
              <div>Liste utilisateurs</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-detail']" class="menu-link">
              <div>Détail utilisateur</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-form']" class="menu-link">
              <div>Formulaire utilisateur</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-roles']" class="menu-link">
              <div>Gestion rôles</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-permissions']" class="menu-link">
              <div>Permissions</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-profile']" class="menu-link">
              <div>Profil utilisateur</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-sessions']" class="menu-link">
              <div>Sessions</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-activity']" class="menu-link">
              <div>Activité</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-groups']" class="menu-link">
              <div>Groupes</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Sous-section : Paramétrage -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-cog"></i>
          <div>Paramétrage</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/settings/general']" class="menu-link">
              <div>Paramètres généraux</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/settings/vehicules-types']" class="menu-link">
              <div>Types de véhicules</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Item : Déconnexion -->
      <li class="menu-item" style="margin-top: 2rem;">
        <a class="menu-link" style="cursor: pointer;" (click)="logout()">
          <i class="menu-icon bx bx-log-out"></i>
          <div>Déconnexion</div>
        </a>
      </li>
    </ul>
  </aside>

  <!-- =========================================================================== -->
  <!-- SECTION : CONTENU PRINCIPAL -->
  <!-- =========================================================================== -->
  <div class="layout-page" [style.marginLeft]="isSidebarCollapsed ? '0' : '280px'">
    <!-- =========================================================== -->
    <!-- SOUS-SECTION : NAVBAR (EN-TÊTE) -->
    <!-- =========================================================== -->
    <nav class="layout-navbar">
      <!-- Contrôles de navigation -->
      <div class="d-flex align-items-center">
        <button class="menu-toggle-btn" (click)="toggleSidebar()">
          <i class='bx bx-menu'></i>
        </button>
        <h3 class="mb-0 ms-3">Création d'un Nouveau Tier</h3>
      </div>

      <!-- Menu utilisateur -->
      <ul class="navbar-nav">
        <li class="nav-item dropdown" (click)="$event.stopPropagation(); toggleUserMenu()">
          <div class="avatar dropdown-toggle">
            <!-- Avatar utilisateur dynamique -->
            <img *ngIf="userPhotoUrl && userPhotoUrl !== ''"
                 [src]="userPhotoUrl"
                 [alt]="userName"
                 (error)="userPhotoUrl = getDefaultAvatar()" />
            <div *ngIf="!userPhotoUrl || userPhotoUrl === ''" class="avatar-default">
              {{ getUserInitials() }}
            </div>
          </div>
          <div class="dropdown-menu" [class.show]="showUserMenu">
            <div style="padding: 1rem;">
              <div class="fw-bold">{{ userName }}</div>
              <div class="text-muted fs-sm">
                {{ currentUser?.roles?.[0] || 'Utilisateur Logistiks' }}
              </div>
              <hr style="margin: 0.5rem 0;">
              <a [routerLink]="['/profile']" class="dropdown-item">
                <i class='bx bx-user me-2'></i> Mon profil
              </a>
              <a [routerLink]="['/settings']" class="dropdown-item">
                <i class='bx bx-cog me-2'></i> Paramètres
              </a>
              <hr style="margin: 0.5rem 0;">
              <a (click)="logout()" class="dropdown-item logout-item">
                <i class='bx bx-log-out me-2'></i> Déconnexion
              </a>
            </div>
          </div>
        </li>
      </ul>
    </nav>

    <!-- =========================================================== -->
    <!-- SOUS-SECTION : CONTENU DE LA PAGE -->
    <!-- =========================================================== -->
    <div class="content-wrapper">
      <!-- =========================================================== -->
      <!-- SECTION : INSTRUCTIONS -->
      <!-- =========================================================== -->
      <div class="row mt-4">
        <div class="col-12">
          <div class="card">
            <div class="card-body">
              <h6 class="card-title mb-3">
                <i class='bx bx-help-circle me-2'></i> Instructions
              </h6>
              <ul class="list-unstyled mb-0">
                <li class="mb-2">
                  <i class='bx bx-check-circle text-success me-2'></i>
                  Les champs marqués d'un astérisque (*) sont obligatoires
                </li>
                <li class="mb-2">
                  <i class='bx bx-info-circle text-primary me-2'></i>
                  Les documents d'identité peuvent être ajoutés après la création
                </li>
                <li class="mb-2">
                  <i class='bx bx-time text-warning me-2'></i>
                  Le tier sera créé avec le statut "En attente de validation"
                </li>
                <li class="mb-2">
                  <i class='bx bx-shield text-danger me-2'></i>
                  Un tiers ne peut être modifié, veuillez vérifier toutes les informations avant de soumettre le formulaire
                </li>
                <li class="mb-2">
                  <i class='bx bx-shield text-danger me-2'></i>
                  Toutes les informations seront vérifiées avant activation
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- =========================================================== -->
      <!-- SECTION : FORMULAIRE DE CRÉATION -->
      <!-- =========================================================== -->
      <div class="row">
        <div class="col-12">
          <div class="card">
            <!-- En-tête du formulaire -->
            <div class="card-header">
              <h5 class="card-title mb-0">Informations du Tier</h5>
              <div class="text-muted fs-sm">
                Remplissez toutes les informations obligatoires (*)
              </div>
            </div>

            <!-- Formulaire principal -->
            <form [formGroup]="tierForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
              <div class="card-body">
                <!-- ================================================= -->
                <!-- SOUS-SECTION : BARRE DE PROGRESSION -->
                <!-- ================================================= -->
                <div class="mb-4">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted fs-sm">Progression du formulaire</span>
                    <span class="fw-semibold">{{ getFormProgress() }}%</span>
                  </div>
                  <div class="progress" style="height: 8px;">
                    <div class="progress-bar sky-blue-progress"
                         role="progressbar"
                         [style.width.%]="getFormProgress()"
                         aria-valuenow="getFormProgress()"
                         aria-valuemin="0"
                         aria-valuemax="100">
                    </div>
                  </div>
                </div>

                <!-- ================================================= -->
                <!-- SOUS-SECTION : INFORMATIONS PERSONNELLES -->
                <!-- ================================================= -->
                <div class="mb-5">
                  <h6 class="section-title mb-3">
                    <i class='bx bx-user-circle me-2'></i> Informations Personnelles
                  </h6>
                  <div class="row">
                    <!-- Champ : Nom -->
                    <div class="col-md-6 mb-3">
                      <label for="lastName" class="form-label">Nom *</label>
                      <input type="text"
                             class="form-control"
                             id="lastName"
                             formControlName="lastName"
                             [class.is-invalid]="submitted && f['lastName'].errors"
                             placeholder="Doe">
                      <div *ngIf="submitted && f['lastName'].errors" class="invalid-feedback">
                        <span *ngIf="f['lastName'].errors['required']">Le nom est obligatoire</span>
                        <span *ngIf="f['lastName'].errors['minlength']">Le nom doit avoir au moins 2 caractères</span>
                      </div>
                    </div>

                    <!-- Champ : Prénom -->
                    <div class="col-md-6 mb-3">
                      <label for="firstName" class="form-label">Prénom *</label>
                      <input type="text"
                             class="form-control"
                             id="firstName"
                             formControlName="firstName"
                             [class.is-invalid]="submitted && f['firstName'].errors"
                             placeholder="John">
                      <div *ngIf="submitted && f['firstName'].errors" class="invalid-feedback">
                        <span *ngIf="f['firstName'].errors['required']">Le prénom est obligatoire</span>
                        <span *ngIf="f['firstName'].errors['minlength']">Le prénom doit avoir au moins 2 caractères</span>
                      </div>
                    </div>

                    <!-- Champ : Nom de l'entreprise (Optionnel) -->
                    <div class="col-md-6 mb-3">
                      <label for="companyName" class="form-label">Nom de l'entreprise</label>
                      <input type="text"
                             class="form-control"
                             id="companyName"
                             formControlName="companyName"
                             placeholder="Logistiks SARL">
                    </div>

                    <!-- Champ : Date de naissance -->
                    <div class="col-md-6 mb-3">
                      <label for="birthDate" class="form-label">Date de naissance</label>
                      <input type="date"
                             class="form-control"
                             id="birthDate"
                             formControlName="birthDate"
                             [max]="maxBirthDate">
                    </div>

                    <!-- Champ : Lieu de naissance -->
                    <div class="col-md-6 mb-3">
                      <label for="placeOfBirth" class="form-label">Lieu de naissance</label>
                      <input type="text"
                             class="form-control"
                             id="placeOfBirth"
                             formControlName="placeOfBirth"
                             placeholder="Paris">
                    </div>
                  </div>
                </div>

                <!-- ================================================= -->
                <!-- SOUS-SECTION : INFORMATIONS D'IDENTIFICATION -->
                <!-- ================================================= -->
                <div class="mb-5">
                  <h6 class="section-title mb-3">
                    <i class='bx bx-id-card me-2'></i> Informations d'Identification
                  </h6>
                  <div class="row">
                    <!-- Champ : Type de pièce d'identité -->
                    <div class="col-md-6 mb-3">
                      <label for="identityType" class="form-label">Type de pièce d'identité *</label>
                      <select class="form-select"
                              id="identityType"
                              formControlName="identityType"
                              [class.is-invalid]="submitted && f['identityType'].errors">
                        <option value="">Sélectionner un type</option>
                        <option [value]="identityTypeOptions.CNI">Carte Nationale d'Identité</option>
                        <option [value]="identityTypeOptions.Passport">Passeport</option>
                        <option [value]="identityTypeOptions.ResidenceCard">Permis de séjour</option>
                        <option [value]="identityTypeOptions.Other">Autre</option>
                      </select>
                      <div *ngIf="submitted && f['identityType'].errors" class="invalid-feedback">
                        Le type de pièce d'identité est obligatoire
                      </div>
                    </div>

                    <!-- Champ : Numéro de pièce d'identité -->
                    <div class="col-md-6 mb-3">
                      <label for="identityNumber" class="form-label">Numéro de pièce d'identité *</label>
                      <input type="text"
                             class="form-control"
                             id="identityNumber"
                             formControlName="identityNumber"
                             [class.is-invalid]="submitted && f['identityNumber'].errors"
                             placeholder="XXXXX000XXXX">
                      <div *ngIf="submitted && f['identityNumber'].errors" class="invalid-feedback">
                        <span *ngIf="f['identityNumber'].errors['required']">Le numéro d'identité est obligatoire</span>
                        <span *ngIf="f['identityNumber'].errors['minlength']">Le numéro doit avoir au moins 5 caractères</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- ================================================= -->
                <!-- SOUS-SECTION : COORDONNÉES -->
                <!-- ================================================= -->
                <div class="mb-5">
                  <h6 class="section-title mb-3">
                    <i class='bx bx-phone me-2'></i> Coordonnées
                  </h6>
                  <div class="row">
                    <!-- Champ : Téléphone principal -->
                    <div class="col-md-6 mb-3">
                      <label for="phone" class="form-label">Téléphone principal *</label>
                      <div class="input-group">
                        <span class="input-group-text">+225</span>
                        <input type="tel"
                               class="form-control"
                               id="phone"
                               formControlName="phone"
                               [class.is-invalid]="submitted && f['phone'].errors"
                               placeholder="0700000000"
                               maxlength="10">
                      </div>
                      <div *ngIf="submitted && f['phone'].errors" class="invalid-feedback d-block">
                        <span *ngIf="f['phone'].errors['required']">Le téléphone est obligatoire</span>
                        <span *ngIf="f['phone'].errors['pattern']">Format invalide (ex: 0700000000)</span>
                      </div>
                    </div>

                    <!-- Champ : Téléphone secondaire -->
                    <div class="col-md-6 mb-3">
                      <label for="secondaryPhone" class="form-label">Téléphone secondaire</label>
                      <div class="input-group">
                        <span class="input-group-text">+225</span>
                        <input type="tel"
                               class="form-control"
                               id="secondaryPhone"
                               formControlName="secondaryPhone"
                               placeholder="0700000001"
                               maxlength="10">
                      </div>
                    </div>

                    <!-- Champ : Email -->
                    <div class="col-md-6 mb-3">
                      <label for="email" class="form-label">Email</label>
                      <input type="email"
                             class="form-control"
                             id="email"
                             formControlName="email"
                             [class.is-invalid]="submitted && f['email'].errors"
                             placeholder="john.doe@example.com">
                      <div *ngIf="submitted && f['email'].errors" class="invalid-feedback">
                        Format d'email invalide
                      </div>
                    </div>
                  </div>
                </div>

                <!-- ================================================= -->
                <!-- SOUS-SECTION : ADRESSE -->
                <!-- ================================================= -->
                <div class="mb-5">
                  <h6 class="section-title mb-3">
                    <i class='bx bx-home me-2'></i> Adresse
                  </h6>
                  <div class="row">
                    <!-- Champ : Rue -->
                    <div class="col-md-6 mb-3">
                      <label for="street" class="form-label">Rue</label>
                      <input type="text"
                             class="form-control"
                             id="street"
                             formControlName="street"
                             placeholder="123 Avenue de la République">
                    </div>

                    <!-- Champ : Ville -->
                    <div class="col-md-6 mb-3">
                      <label for="city" class="form-label">Ville</label>
                      <input type="text"
                             class="form-control"
                             id="city"
                             formControlName="city"
                             placeholder="Abidjan">
                    </div>

                    <!-- Champ : Pays -->
                    <div class="col-md-6 mb-3">
                      <label for="country" class="form-label">Pays</label>
                      <select class="form-select" id="country" formControlName="country">
                        <option value="">Sélectionner un pays</option>
                        <option value="CI">Côte d'Ivoire</option>
                        <option value="FR">France</option>
                        <option value="SN">Sénégal</option>
                        <option value="ML">Mali</option>
                        <option value="BF">Burkina Faso</option>
                        <option value="GN">Guinée</option>
                      </select>
                    </div>

                    <!-- Champ : Code postal -->
                    <div class="col-md-6 mb-3">
                      <label for="zipCode" class="form-label">Code postal</label>
                      <input type="text"
                             class="form-control"
                             id="zipCode"
                             formControlName="zipCode"
                             placeholder="22500">
                    </div>
                  </div>
                </div>

                <!-- ================================================= -->
                <!-- SOUS-SECTION : RÔLES -->
                <!-- ================================================= -->
                <div class="mb-5">
                  <h6 class="section-title mb-3">
                    <i class='bx bx-briefcase me-2'></i> Rôles *
                  </h6>
                  <div class="alert alert-info">
                    <i class='bx bx-info-circle me-2'></i>
                    Sélectionnez au moins un rôle pour définir le type de tier.
                  </div>

                  <div class="row">
                    <!-- Cases à cocher : Rôles disponibles -->
                    <div class="col-md-6 mb-3" *ngFor="let role of availableRoles">
                      <div class="form-check">
                        <input class="form-check-input"
                               type="checkbox"
                               [id]="'role-' + role.value"
                               [value]="role.value"
                               (change)="onRoleChange($event)">
                        <label class="form-check-label d-flex align-items-center" [for]="'role-' + role.value">
                          <i [class]="role.icon + ' me-2'"></i>
                          <div>
                            <div class="fw-semibold">{{ role.label }}</div>
                            <small class="text-muted">{{ role.description }}</small>
                          </div>
                        </label>
                      </div>
                    </div>
                  </div>

                  <!-- Message d'erreur si aucun rôle sélectionné -->
                  <div *ngIf="submitted && selectedRoles.length === 0" class="alert alert-danger mt-3">
                    <i class='bx bx-error-circle me-2'></i>
                    Au moins un rôle doit être sélectionné
                  </div>
                </div>

                <!-- ================================================= -->
                <!-- SOUS-SECTION : INFORMATIONS SUPPLÉMENTAIRES -->
                <!-- ================================================= -->
                <div class="mb-5">
                  <h6 class="section-title mb-3">
                    <i class='bx bx-note me-2'></i> Informations Supplémentaires
                  </h6>
                  <div class="mb-3">
                    <label for="notes" class="form-label">Notes</label>
                    <textarea class="form-control"
                              id="notes"
                              formControlName="notes"
                              rows="3"
                              placeholder="Notes additionnelles concernant le tier..."></textarea>
                  </div>
                </div>

              </div>

              <!-- ================================================= -->
              <!-- SECTION : PIED DE PAGE DU FORMULAIRE -->
              <!-- ================================================= -->
              <div class="card-footer bg-transparent border-top-0">
                <div class="d-flex justify-content-between">
                  <!-- Bouton : Annuler -->
                  <button type="button"
                          class="btn btn-outline-secondary"
                          (click)="onCancel()">
                    <i class='bx bx-x me-1'></i> Annuler
                  </button>

                  <!-- Boutons d'action -->
                  <div class="d-flex gap-2">
                    <!-- Bouton : Soumettre le formulaire -->
                    <button type="submit"
                            class="btn btn-primary"
                            [disabled]="loading">
                      <i class='bx bx-check me-1'></i>
                      <span *ngIf="!loading">Créer le tier</span>
                      <span *ngIf="loading">
                        <span class="spinner-border spinner-border-sm me-1"
                              role="status"
                              aria-hidden="true"></span>
                        Création en cours...
                      </span>
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
