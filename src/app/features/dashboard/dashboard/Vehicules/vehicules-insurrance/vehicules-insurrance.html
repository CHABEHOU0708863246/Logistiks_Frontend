<div class="layout-wrapper">
  <!-- =========================================================================== -->
  <!-- SECTION 1: SIDEBAR DE NAVIGATION PRINCIPALE -->
  <!-- =========================================================================== -->
  <aside class="layout-menu" id="sidebar">
    <!-- Brand/Logo de l'application -->
    <div class="app-brand">
      <i class='bx bxs-truck' style="font-size: 2rem; color: white;"></i>
      <div>
        <span class="app-brand-text">Logistiks</span>
        <div class="app-brand-subtitle">Gestion de flotte et locations</div>
      </div>
    </div>

    <!-- Menu principal -->
    <ul class="menu-inner">
      <!-- Dashboard principal -->
      <li class="menu-item" routerLinkActive="active">
        <a [routerLink]="['/dashboard']" class="menu-link">
          <i class="menu-icon bx bx-home-circle"></i>
          <div>Dashboard</div>
        </a>
      </li>

      <!-- ========================================== -->
      <!-- SECTION 1.1: RÉFÉRENTIELS -->
      <!-- ========================================== -->
      <li class="menu-header">
        <span>RÉFÉRENTIELS</span>
      </li>

      <!-- Module Tiers -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-group"></i>
          <div>Tiers</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers']" class="menu-link">
              <div>Tous les tiers</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers/documents-validation']" class="menu-link">
              <div>Documents à valider</div>
              <span class="badge badge-warning" *ngIf="dashboardStats.documentsPending > 0">
                {{ dashboardStats.documentsPending }}
              </span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers/documents-management']" class="menu-link">
              <div>Gestion des documents</div>
              <span class="badge badge-info">
                <i class='bx bx-upload'></i>
                {{ dashboardStats.documentsPending > 0 ? dashboardStats.documentsPending : '' }}
              </span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/tiers/new']" class="menu-link">
              <div>Nouveau tier</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Module Véhicules -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-car"></i>
          <div>Véhicules</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules']" class="menu-link">
              <div>Tous les véhicules</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/ajouter']" class="menu-link">
              <div>Ajouter vehicule</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/affectations']" class="menu-link">
              <div>Affectations</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/entretien']" class="menu-link">
              <div>Suivi entretien</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/vehicules/assurances']" class="menu-link">
              <div>Assurances</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Module Documents -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-folder"></i>
          <div>Documents</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents']" class="menu-link">
              <div>Tous les documents</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents/contrats']" class="menu-link">
              <div>Contrats signés</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents/identite']" class="menu-link">
              <div>Pièces d'identité</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/documents/factures']" class="menu-link">
              <div>Factures fournisseurs</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- ========================================== -->
      <!-- SECTION 1.2: CŒUR MÉTIER -->
      <!-- ========================================== -->
      <li class="menu-header">
        <span>CŒUR MÉTIER</span>
      </li>

      <!-- Module Contrats -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-file"></i>
          <div>Contrats</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats']" class="menu-link">
              <div>Tous les contrats</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats/actifs']" class="menu-link">
              <div>Contrats actifs</div>
              <span class="badge badge-success">12</span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats/expiration']" class="menu-link">
              <div>À expiration</div>
              <span class="badge badge-warning">3</span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/contrats/new']" class="menu-link">
              <div>Nouveau contrat</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Module Calendrier -->
      <li class="menu-item" routerLinkActive="active">
        <a [routerLink]="['/dashboard/calendrier']" class="menu-link">
          <i class="menu-icon bx bx-calendar"></i>
          <div>Calendrier & Échéances</div>
        </a>
      </li>

      <!-- ========================================== -->
      <!-- SECTION 1.3: FINANCE & COMPTABILITÉ -->
      <!-- ========================================== -->
      <li class="menu-header">
        <span>FINANCE & COMPTABILITÉ</span>
      </li>

      <!-- Module Comptes -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-credit-card"></i>
          <div>Comptes</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/comptes-bancaires']" class="menu-link">
              <div>Comptes bancaires</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/mobile-money']" class="menu-link">
              <div>Mobile Money</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/bilans']" class="menu-link">
              <div>Soldes & Bilans</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Module Paiements -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-wallet"></i>
          <div>Paiements</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/paiements']" class="menu-link">
              <div>Tous les paiements</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/paiements/retard']" class="menu-link">
              <div>En retard</div>
              <span class="badge badge-danger">5</span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/finance/paiements/attente']" class="menu-link">
              <div>En attente</div>
              <span class="badge badge-warning">8</span>
            </a>
          </li>
        </ul>
      </li>

      <!-- ========================================== -->
      <!-- SECTION 1.4: ADMINISTRATION -->
      <!-- ========================================== -->
      <li class="menu-header">
        <span>ADMINISTRATION</span>
      </li>

      <!-- Module Utilisateurs -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-user"></i>
          <div>Utilisateurs</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/users-list']" class="menu-link">
              <div>Liste utilisateurs</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-detail']" class="menu-link">
              <div>Détail utilisateur</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-form']" class="menu-link">
              <div>Formulaire utilisateur</div>
              <span class="badge badge-primary"><i class='bx bx-plus'></i></span>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-roles']" class="menu-link">
              <div>Gestion rôles</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-permissions']" class="menu-link">
              <div>Permissions</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-profile']" class="menu-link">
              <div>Profil utilisateur</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-sessions']" class="menu-link">
              <div>Sessions</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-activity']" class="menu-link">
              <div>Activité</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/admin/user-groups']" class="menu-link">
              <div>Groupes</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Module Paramétrage -->
      <li class="menu-item" routerLinkActive="active open">
        <a href="javascript:void(0);" class="menu-link menu-toggle" (click)="toggleMenu($event)">
          <i class="menu-icon bx bx-cog"></i>
          <div>Paramétrage</div>
        </a>
        <ul class="menu-sub">
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/settings/general']" class="menu-link">
              <div>Paramètres généraux</div>
            </a>
          </li>
          <li class="menu-item" routerLinkActive="active">
            <a [routerLink]="['/dashboard/settings/vehicules-types']" class="menu-link">
              <div>Types de véhicules</div>
            </a>
          </li>
        </ul>
      </li>

      <!-- Déconnexion -->
      <li class="menu-item" style="margin-top: 2rem;">
        <a class="menu-link" style="cursor: pointer;" (click)="logout()">
          <i class="menu-icon bx bx-log-out"></i>
          <div>Déconnexion</div>
        </a>
      </li>
    </ul>
  </aside>

  <!-- =========================================================================== -->
  <!-- SECTION 2: CONTENU PRINCIPAL DE LA PAGE -->
  <!-- =========================================================================== -->
  <div class="layout-page" [style.marginLeft]="isSidebarCollapsed ? '0' : '280px'">

    <!-- ========================================== -->
    <!-- SECTION 2.1: NAVBAR SUPERIEURE -->
    <!-- ========================================== -->
    <nav class="layout-navbar">
      <!-- Contrôles de navigation -->
      <div class="d-flex align-items-center">
        <!-- Bouton de bascule de la sidebar -->
        <button class="menu-toggle-btn" (click)="toggleSidebar()">
          <i class='bx bx-menu'></i>
        </button>
        <!-- Titre de la page -->
        <h3 class="mb-0 ms-3">Gestion des assurance</h3>
      </div>

      <!-- Menu utilisateur -->
      <ul class="navbar-nav">
        <!-- Dropdown utilisateur avec photo dynamique -->
        <li class="nav-item dropdown" (click)="$event.stopPropagation(); toggleUserMenu()">
          <div class="avatar dropdown-toggle">
            <!-- Photo de profil -->
            <img *ngIf="userPhotoUrl && userPhotoUrl !== ''"
                 [src]="userPhotoUrl"
                 [alt]="userName"
                 (error)="userPhotoUrl = getDefaultAvatar()" />
            <!-- Avatar par défaut si pas de photo -->
            <div *ngIf="!userPhotoUrl || userPhotoUrl === ''" class="avatar-default">
              {{ getUserInitials() }}
            </div>
          </div>
          <!-- Menu déroulant utilisateur -->
          <div class="dropdown-menu" [class.show]="showUserMenu">
            <div style="padding: 1rem;">
              <!-- Informations utilisateur -->
              <div class="fw-bold">{{ userName }}</div>
              <div class="text-muted fs-sm">
                {{ currentUser?.roles?.[0] || 'Utilisateur Logistiks' }}
              </div>
              <hr style="margin: 0.5rem 0;">

              <!-- Liens du menu utilisateur -->
              <a [routerLink]="['/profile']" class="dropdown-item">
                <i class='bx bx-user me-2'></i> Mon profil
              </a>
              <a [routerLink]="['/settings']" class="dropdown-item">
                <i class='bx bx-cog me-2'></i> Paramètres
              </a>
              <hr style="margin: 0.5rem 0;">

              <!-- Déconnexion -->
              <a (click)="logout()" class="dropdown-item logout-item">
                <i class='bx bx-log-out me-2'></i> Déconnexion
              </a>
            </div>
          </div>
        </li>
      </ul>
    </nav>

    <!-- ========================================== -->
    <!-- SECTION 2.2: CONTENU DU FORMULAIRE -->
    <!-- ========================================== -->
    <div class="content-wrapper">

    </div>
          <!-- COMPOSANT DE NOTIFICATION -->
      <app-notification-component></app-notification-component>
  </div>
</div>
